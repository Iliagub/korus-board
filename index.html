<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<title>KORUS Market</title>

<style>
body{
  margin:0;
  background:#F5F7F9;
  font-family:'Inter', sans-serif;
  color:#1F2937;
}

.container{
  padding:20px;
}

h1{
  font-size:22px;
  font-weight:700;
  margin-bottom:5px;
}

.subtitle{
  color:#6B7280;
  margin-bottom:20px;
}

button{
  width:100%;
  padding:14px;
  margin:8px 0;
  border:none;
  border-radius:12px;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
}

.primary{
  background:#00AA5B;
  color:white;
}

.secondary{
  background:white;
  border:1px solid #E5E7EB;
}

.card{
  background:white;
  padding:15px;
  border-radius:14px;
  margin:10px 0;
  box-shadow:0 4px 12px rgba(0,0,0,0.05);
}

.category{
  font-size:12px;
  font-weight:600;
  color:#00AA5B;
  margin-bottom:5px;
}

input, textarea, select{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:10px;
  border:1px solid #E5E7EB;
  font-size:14px;
}
</style>
</head>

<body>
<div class="container">

<div id="home">
  <h1>KORUS Market</h1>
  <div class="subtitle">–õ–æ–∫–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</div>

  <button class="secondary" onclick="showCategory('–†–∞–±–æ—Ç–∞')">üíº –†–∞–±–æ—Ç–∞</button>
  <button class="secondary" onclick="showCategory('–ñ–∏–ª—å—ë')">üè† –ñ–∏–ª—å—ë</button>
  <button class="secondary" onclick="showCategory('–ü—Ä–æ–¥–∞–º')">üõí –ü—Ä–æ–¥–∞–º</button>
  <button class="secondary" onclick="showCategory('–£—Å–ª—É–≥–∏')">üß∞ –£—Å–ª—É–≥–∏</button>

  <button class="primary" onclick="showForm()">‚ûï –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</button>
</div>

<div id="form" style="display:none;">
  <h1>–ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h1>

  <select id="category">
    <option value="–†–∞–±–æ—Ç–∞">–†–∞–±–æ—Ç–∞</option>
    <option value="–ñ–∏–ª—å—ë">–ñ–∏–ª—å—ë</option>
    <option value="–ü—Ä–æ–¥–∞–º">–ü—Ä–æ–¥–∞–º</option>
    <option value="–£—Å–ª—É–≥–∏">–£—Å–ª—É–≥–∏</option>
  </select>

  <input id="title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫">
  <textarea id="text" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>

  <button class="primary" onclick="saveAd()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  <button class="secondary" onclick="goHome()">–ù–∞–∑–∞–¥</button>
</div>

<div id="list" style="display:none;">
  <h1 id="categoryTitle"></h1>
  <div id="ads"></div>
  <button class="secondary" onclick="goHome()">–ù–∞–∑–∞–¥</button>
</div>

</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

const user = tg.initDataUnsafe?.user;

function showForm(){
  home.style.display='none';
  form.style.display='block';
}

function goHome(){
  home.style.display='block';
  form.style.display='none';
  list.style.display='none';
}

function saveAd(){
  const category=document.getElementById('category').value;
  const title=document.getElementById('title').value;
  const text=document.getElementById('text').value;

  let ads=JSON.parse(localStorage.getItem('ads'))||[];

  ads.push({
    category,
    title,
    text,
    userId:user?.id || null,
    userName:user?.first_name || "–ê–Ω–æ–Ω–∏–º"
  });

  localStorage.setItem('ads',JSON.stringify(ads));
  alert("–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ");
  goHome();
}

function showCategory(name){
  home.style.display='none';
  list.style.display='block';
  categoryTitle.innerText=name;

  let ads=JSON.parse(localStorage.getItem('ads'))||[];
  let html='';

  ads.filter(ad=>ad.category===name).forEach(ad=>{
    html+=`
      <div class="card">
        <div class="category">${ad.category}</div>
        <b>${ad.title}</b><br><br>
        ${ad.text}<br><br>
        <small>–ê–≤—Ç–æ—Ä: ${ad.userName}</small>
      </div>
    `;
  });

  ads.innerHTML=html;
}
</script>

</body>
</html>
